{% extends "base.html" %}
{% block title %}Transcript - {{ transcript.channel_name }}{% endblock %}

<meta http-equiv="refresh" content="30">
{% block content %}
<style>
    .transcript-header { border-bottom: 1px solid var(--bg-lighter); padding-bottom: 15px; margin-bottom: 30px; }
    .transcript-header h1 { margin: 0; font-size: 24px; color: #fff; }
    .transcript-header p { margin: 5px 0 0; color: var(--text-dark); }
    .message-group { display: flex; margin-bottom: 25px; }
    .avatar { width: 40px; height: 40px; border-radius: 50%; margin-right: 15px; flex-shrink: 0; }
    .message-content { flex-grow: 1; }
    .author-info { display: flex; align-items: center; margin-bottom: 5px; }
    .author-name { font-weight: 600; color: #fff; margin-right: 10px; }
    .timestamp { font-size: 12px; color: var(--text-dark); }
    .message-text { line-height: 1.5; white-space: pre-wrap; word-wrap: break-word; }
    .message-text img { max-width: 100%; border-radius: 6px; margin-top: 8px; }
</style>

<div class="transcript-header">
    <h1>#{{ transcript.channel_name }}</h1>
    <p>
        Serveur : {{ transcript.guild_id }} | {{ transcript.messages | length }} messages
    </p>
</div>

{% for message in transcript.messages %}
<div class="message-group">
    <img src="{{ message.author_avatar }}" alt="Avatar" class="avatar">
    <div class="message-content">
        <div class="author-info">
            <span class="author-name">{{ message.author_name }}</span>
            <span class="timestamp">{{ message.timestamp | replace('T', ' ') | slice(0, 19) }}</span>
        </div>
        {% if message.content %}
        <div class="message-text">{{ message.content }}</div>
        {% endif %}
        {% for attachment in message.attachments %}
        <div class="message-text">
            <a href="{{ attachment }}" target="_blank"><img src="{{ attachment }}" alt="PiÃ¨ce jointe"></a>
        </div>
        {% endfor %}
    </div>
</div>
{% endfor %}

{% endblock %}